%\documentclass[12pt,a4paper,twoside]{memoir}
\documentclass[a4paper,twoside,final]{book} %%% twoside pour final
%\documentclass[a4paper,oneside,draft]{book} %%% draft pour voir tout ce qui depasse dans les marges
%%\documentclass[a4paper,oneside]{book}

\usepackage[utf8]{inputenc}
\usepackage[francais,frenchb]{babel}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amsfonts,amssymb}
\usepackage{amsthm} %% \newtheorem
\usepackage{graphicx}

\usepackage{lmodern} %% latin modern font
%\usepackage{fcursive}
%%\usepackage[mathscr]{euscript}
\usepackage{euscript}
\usepackage{dsfont}
\usepackage{mathrsfs} %% fournit \mathsrc (majuscules rondes)
\DeclareMathAlphabet{\mathpzc}{OT1}{pzc}{m}{it}
\DeclareMathAlphabet{\matheus}{U}{eus}{m}{n}
\DeclareTextFontCommand{\textpzc}{\fontfamily{pzc}\fontseries{m}\fontshape{n}\selectfont}

%\usepackage{scrextend} %%% http://tex.stackexchange.com/questions/5339/how-to-specify-font-size-less-than-10pt-or-more-than-12pt
%\changefontsizes[20pt]{16pt}
\usepackage[fontsize=13pt]{scrextend}
%\usepackage{frcursive} %fournit l'environnement cursive, qui imite une écriture manuelle
%%%\usepackage{microtype} %% Permet de reduire l'espace entre les caracteres
\usepackage{relsize}
\usepackage{lettrine}

\usepackage[titles]{tocloft}
\setlength{\cftchapnumwidth}{0pt}
\setlength{\cftbeforechapskip}{\baselineskip}
\renewcommand{\cftchapaftersnum}{.}
\renewcommand{\cftchapaftersnumb}{\newline}
%%\renewcommand{\cftchappresnum}{\chaptername\ }
%\makeatletter%
%\ifx\@chapapp\appendixname%
%\renewcommand{\cftchappresnum}{Annexe\ }%
%\else%
%\renewcommand{\cftchappresnum}{\chaptername\ }%
%\fi%
%\makeatother%
\makeatletter
\newcommand*\updatechaptername{%
        \addtocontents{toc}{\protect\renewcommand*\protect\cftchappresnum{\@chapapp\ }}%
}
\makeatother


%%%\usepackage[titletoc,title]{appendix}
%\usepackage[toc,page]{appendix} %% option toc quio ne marche pas --> appel manuel a \addappheadtotoc
\usepackage[page]{appendix}
\renewcommand{\appendixtocname}{{\fontfamily{pzc}\selectfont \Large  Annexes}}
%\renewcommand{\appendixpagename}{Annexes}
\def\appendixpage{\newpage\vspace*{9cm}
\begin{center}
%\Huge\textbf{Annexes}
%\textpzc{\fontsize{2cm}{1em}\selectfont ANNEXES}
\textpzc{\fontsize{3cm}{1em}\selectfont Annexes}
\end{center}
%%$$\Huge\mathcal{Annexes}$$
%$$\Huge\mathpzc{\sc Annexes}$$
\thispagestyle{empty}
}

%%%\usepackage{afterpage}%  %%% Evite le comportement grande figure sur une seule et unique page
\usepackage{float}% Fournit l'option H pour les figures

\usepackage{mathabx} %% Pour avoir proprement le grand symbole \sqrt notamment
\usepackage{mathtools}
\usepackage{caption} %% Permet d'utiliser \captionof sans etre dans un environnement figure
\usepackage{subfig}%% \subfloat
\usepackage{wrapfig}%% \begin{wrapfigure}
%%\usepackage{stackengine}
\usepackage{vwcol} 
\usepackage{placeins} %%% Fournit \FloatBarrier
\usepackage{xspace}
\usepackage{lipsum}
\usepackage{booktabs} %% midrule
\usepackage{array}
\usepackage{multicol}
\usepackage{multirow}
\usepackage{colortbl} %% rowcolor
\usepackage[table]{xcolor} %% gray!40  %% rowcolors
\usepackage{datatool} %%%% See the documentation :
%%%% http://texdoc.net/texmf-dist/doc/latex/datatool/datatool-user.pdf
\usepackage{pict2e}
\usepackage{slashbox}
\usepackage{xfrac}
\usepackage{hhline}
\usepackage{spreadtab}
\usepackage{rotating}

\frenchbsetup{StandardLists=true} %% Resolves conflict between babel and enumitem
\usepackage{enumitem} %%% Personalisation des puces pour les listes 
%%\usepackage{enumerate}

\usepackage{tabularx}
\usepackage{tablefootnote}
%%\usepackage{xcolor} (repetition)
%%\usepackage{showkeys} %%% Pour faire afficher les label utilisés
%%%%%\usepackage[plain]{fancyref}
\usepackage{xr}
\usepackage{hyperref} %%% Les premieres compilations fournisse une erreur. recompiler plsrs fois ...

%%% Dimension page pour final
%\usepackage[left=35mm,right=25mm,top=30mm,bottom=30mm]{geometry} 
%%% Dimension page pour todonote a droite
\usepackage[left=40mm,right=20mm,top=30mm,bottom=30mm]{geometry}
\usepackage[textwidth=30mm]{todonotes} %%% Ajuster le textwidth en fct de la marge
%\usepackage[disable]{todonotes}
\reversemarginpar %%% pour que les notes alterne au niveau des marges (mode twoside)
\setlength{\marginparwidth}{3cm}%%% pour regler la posiition des notes sur page impaire

\usepackage{tcolorbox}
\usepackage{subfiles}
%%\usepackage{etoolbox}
\usepackage{tikz,tkz-tab}
\usepackage{pgfplots}

%\usepackage{titletoc}
%\dottedcontents{subsection}[9em]{}{3em}{.5pc}
%\dottedcontents{section}[6.5em]{}{2em}{.5pc}
%\dottedcontents{chapter}[4em]{\vspace{7mm}}{2em}{.5pc}


%%%%% fncychap predefini
%\usepackage[Glenn]{fncychap}
%\usepackage[Conny]{fncychap}
\usepackage[Bjornstrup]{fncychap}
%\usepackage[Peters]{fncychap}
%\usepackage{fncychap}
%%\usepackage{fancyhdr} %%%% incompatible avec la class memoir
\usepackage{fancyhdr}

%%%%%% Parametrage des entetes et pied de page %%%%%%%%
\pagestyle{fancy}
%\fancyhead{}% efface le contenu de l'en-tete
%\fancyfoot{}% efface le contenu du pied de page

\renewcommand{\chaptermark}[1]{\markboth{{\sc \chaptername } \thechapter.\ #1}{}}
\renewcommand{\sectionmark}[1]{\markright{\thesection.\ #1}}
\addtolength{\footskip}{7mm}%
 
%\lhead[]{\leftmark}
%\rhead[\rightmark]{}
%\lfoot[Guillaume Lefebvre]{\thepage}
%\rfoot[\thepage]{Guillaume Lefebvre}
%%\renewcommand{\headheight}{15pt}
%%\renewcommand{\headsep}{16pt}
%%\renewcommand{\footskip}{40pt}
%%\makeatletter
%%\let\ps@plain=\ps@fancy
%%\makeatother
%\fancypagestyle{plain}{
%\lhead[]{}
%\renewcommand{\headrulewidth}{0pt}%
%}

\fancypagestyle{main}{%
  \fancyhf{}%
  \lhead[\leftmark]{}
  \rhead[]{\rightmark}
  \fancyfoot[LE,RO]{{\normalsize \thepage}}%
  \fancyfoot[LO,RE]{{\footnotesize Guillaume Lefebvre}}%
  \renewcommand{\headrulewidth}{0.4pt}%
}

\fancypagestyle{plain}{%
  \fancyhf{}%
%  \lhead[\leftmark]{}
%  \rhead[]{\rightmark}
  \fancyfoot[LE,RO]{{\normalsize \thepage}}%
  \fancyfoot[LO,RE]{{\footnotesize Guillaume Lefebvre}}%
  %%\addtolength{\footskip}{7mm}%
  \renewcommand{\headrulewidth}{0pt}%
}

\fancypagestyle{prefacestyle}{%
  \fancyhf{}%
%  \lhead[\leftmark]{}
%  \rhead[]{\rightmark}
  \fancyhead[LE,RO]{~\chaptername~}
  \fancyfoot[LE,RO]{{\normalsize \thepage}}%
  \fancyfoot[LO,RE]{{\footnotesize Guillaume Lefebvre}}%
  %%\addtolength{\footskip}{7mm}%
  \renewcommand{\headrulewidth}{0.4pt}%
}

\appto\frontmatter{\pagestyle{prefacestyle}}
%\appto\frontmatter{\pagestyle{main}}
\appto\mainmatter{\pagestyle{main}}
\appto\backmatter{\pagestyle{main}}




%%%%%%% Variables d'environnement
\graphicspath{{../img/}{../img_publi_GIST/}} %%


\setlength\doublerulesep{2mm} %% hauteur entre 2 \hline successifs
\newlength{\retraittableau}
\setlength{\retraittableau}{-4mm}
\newlength{\firstcolwidth} %% on ne peut mettre ni chiffre ni caractere special dans le nom d'une longueur
\setlength{\firstcolwidth}{22mm}
\newlength{\defaultcolumnsep}
\setlength{\defaultcolumnsep}{25pt}
\setlength\columnsep{\defaultcolumnsep}

%\setlist[enumerate,1]{label=\arabic*)}
%\setlist[enumerate,2]{label=\alph*.}
%\setlist[itemize,1]{label=$\circ$}
\newenvironment{myitemize}[1][]{%
\itemize[label=\textbullet ,noitemsep, topsep=0pt,partopsep=0pt, #1 ]%
}{\enditemize}
\newenvironment{myenumerate}[1][]{%
\enumerate[label=\arabic*. ,noitemsep, topsep=.5\topsep, #1 ]%
}{\endenumerate}

\theoremstyle{definition}
\newtheorem{thm}{Théorème}[section]
\newtheorem{dfn}[thm]{Définition}
\newtheorem{prop}[thm]{Propriété}
\newtheorem{lemme}[thm]{Lemme}
\newtheorem{coro}[thm]{Corollaire}

\DeclareMathOperator{\atan}{atan}
\DeclareMathOperator{\atanh}{atanh}

%\setcounter{secnumdepth}{3}
%\setcounter{tocdepth}{3}

%%http://ctan.mines-albi.fr/macros/latex/contrib/lettrine/doc/demo.pdf
\renewcommand{\LettrineFontHook}{
%\fontfamily{yfrak}
\fontfamily{pag}
\fontseries{bx}\fontshape{it}
%\color[gray]{0.5}
}

\renewcommand{\qedsymbol}{$\blacksquare$} %%% Personnalisation du symbole de fin de preuve
%%%% Commande jouent le role inverse de \nonumber dans les environnement avec * (align* par ex.)
\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}

%%%%%%% Personnalisation des legendes
%\captionsetup[figure]{labelfont=it,textfont={bf,it}}
%\captionsetup[subfigure]{labelfont=bf,textfont=normalfont,justification=raggedright}

\newcommand{\mylettrine}[2]{\lettrine[lines=2, lhang=0.33, loversize=0.25]{#1}{#2}} 
%\newcommand{\mylettrine}[2]{\lettrine[lines=2, lhang=0.33, loversize=0.25]{$\mathscr{#1}$}{#2}} 

\newcommand{\custompart}[3]{
%%%% A voir : \setpartpreamble[taille_facultative]{texte du preambule} du package Koma-script
%%% Fournit aussi : 
%% \renewcommand*{\dictumauthorformat}[1]{\color{blue} \bfseries #1}
%% \dictum[auteur de l’aphorisme]{le texte de l’aphorisme}
%% cf. http://bertrandmasson.free.fr/index.php?categorie5/latex-koma-script
\part{ 
#1 \\ {
% \bf %% bold
% \it %% italic
%\tt %% typewriter style
%\sl %% slanted typestyle
%\rm %%% roman style
%\sc %%% small caps
\sf %% sans serif
\LARGE #2 }
\\ \vspace{3cm}
%\newpage
%\begin{tabular}{p{130mm}}
\normalsize \normalfont #3
%\end{tabular}
}
%\cleardoublepage
}


\newcommand{\specialchap}[1]{%
%%%% Chapitre sans sections
\chapter{#1}%
\pagestyle{prefacestyle}%
\renewcommand\chaptername{#1}%
}

\makeatletter
\newcommand{\leqnomode}{\tagsleft@true}
\newcommand{\reqnomode}{\tagsleft@false}
\makeatother

\input{mes_macros.tex}


%%%===============================%%%%
%%%       DEBUT DU DOCUMENT      %%%%
%%%===============================%%%%
\begin{document}
\renewcommand{\contentsname}{Sommaire}
\renewcommand*{\listtablename}{Liste des tableaux}
\renewcommand*{\listfigurename}{Liste des figures}

%%\thispagestyle{empty}
%%\maketitle

\frontmatter % Le prologue du livre
%%\updatechaptername
%%\renewcommand\chaptername{Sommaire}
\pagestyle{plain}
%%\setcounter{tocdepth}{5}
\addcontentsline{toc}{chapter}{Sommaire}
\tableofcontents    % Table des matières

\specialchap{Avant-propos}
%\chapter{Avant-propos}
%\pagestyle{prefacestyle}
%\renewcommand\chaptername{Avant-Propos}
\lipsum[1-11]

\specialchap{Introduction}
%\chapter{Introduction}

\mainmatter % Corps du livre
\renewcommand\chaptername{Chapitre}
\updatechaptername

%%%\newcommand{\mainfile}{} % we use the existence of this command to see if we're compiling the whole thesis or just a chapter


%{\tiny abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXZ}\\
%{\scriptsize abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXZ}\\
%{\footnotesize abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXZ}\\
%{\small abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXZ}\\
%{\normalsize abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXZ}\\
%{\large abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXZ}\\
%{\Large abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXZ}\\
%{\LARGE abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXZ}\\
%{\huge abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXZ}\\
%{\Huge abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXZ}\\
%\lipsum[1]

%\custompart{Modèles EDPs de croissance tumorale}{Cas des métastases hépatiques}{Description de la partie.... }

%\subfile{chap1}
\subfile{chap_biologie_du_cancer}
\subfile{chap_modeleEDP}
\subfile{chap_trefle}
\subfile{chap_optim_grey}
\subfile{chap_analyse_heterogeneite}

\appendix %%%% Les annexes
\addappheadtotoc %%% Pour la page debutant les annexes apparaisse dans la toc
\updatechaptername
%%\renewcommand\thechapter{\appendixname~\Alph{chapter}}
\renewcommand\chaptername{Annexe}
%%\renewcommand\chaptername{}
%\renewcommand*{\cftchappresnum}{Annexe~}
\begin{appendices}
\subfile{annexe_tableaux_graphiques_complementaires}
\subfile{annexe_schema_mixte_EFVF}
\subfile{annexe_penalisation}
\subfile{annexe_gaussienne}
\end{appendices}

\backmatter  %%%% l'épilogue du document
\specialchap{Test}
%\updatechaptername
%\renewcommand\chaptername{Test}
%\chapter{Test} %%%pour allonger le sommaire (pour faire des tests)
\subsubsection{test1}\paragraph{hep}
\subsubsection{test2}\paragraph{hep}
\subsubsection{test3}\paragraph{hep}
\subsubsection{test4}\paragraph{hep}
\subsubsection{test5}\paragraph{hep}
\subsubsection{test6}\paragraph{hep}
\subsubsection{test7}\paragraph{hep}
\subsubsection{test8}\paragraph{hep}
\subsubsection{test9}\paragraph{hep}
\subsubsection{test10}\paragraph{hep}
\subsubsection{test11}\paragraph{hep}
\subsubsection{test12}\paragraph{hep}
\subsubsection{test13}\paragraph{hep}
\subsubsection{test14}\paragraph{hep}

\specialchap{Remerciements} %%% defauts si mis dans un autre fichier avec subfile
%\chapter{Remerciements}
%\renewcommand\chaptername{Remerciements}
\input{remerciements.tex}

%%\chapter{Conclusion et discussion}

% Les différentes tables
%\tableofcontents    % Table des matières
%\listoffigures        % Liste des figures
%\listoftables        % Liste des tableaux
%------------ Acronyms List ----------------------------------
%\thispagestyle{fancyplain}
%\chapter*{List of Acronyms}
%\addcontentsline{toc}{chapter}{List of Acronyms}


%%%% Bibliographie
%\nocite{*}
%\bibliographystyle{plain}
%\bibliography{biblio}
\end{document}
